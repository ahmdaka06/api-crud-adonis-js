!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e.indicative=e.indicative||{},e.indicative.sanitizor=t())}(this,function(){"use strict";var e,t=(function(e){var t=function(){function e(e,t){return null!=t&&e instanceof t}var t,r,n;try{t=Map}catch(e){t=function(){}}try{r=Set}catch(e){r=function(){}}try{n=Promise}catch(e){n=function(){}}function o(i,f,a,c,s){"object"==typeof f&&(a=f.depth,c=f.prototype,s=f.includeNonEnumerable,f=f.circular);var l=[],p=[],y="undefined"!=typeof Buffer;return void 0===f&&(f=!0),void 0===a&&(a=1/0),function i(a,d){if(null===a)return null;if(0===d)return a;var b,v;if("object"!=typeof a)return a;if(e(a,t))b=new t;else if(e(a,r))b=new r;else if(e(a,n))b=new n(function(e,t){a.then(function(t){e(i(t,d-1))},function(e){t(i(e,d-1))})});else if(o.__isArray(a))b=[];else if(o.__isRegExp(a))b=new RegExp(a.source,u(a)),a.lastIndex&&(b.lastIndex=a.lastIndex);else if(o.__isDate(a))b=new Date(a.getTime());else{if(y&&Buffer.isBuffer(a))return b=Buffer.allocUnsafe?Buffer.allocUnsafe(a.length):new Buffer(a.length),a.copy(b),b;e(a,Error)?b=Object.create(a):void 0===c?(v=Object.getPrototypeOf(a),b=Object.create(v)):(b=Object.create(c),v=c)}if(f){var g=l.indexOf(a);if(-1!=g)return p[g];l.push(a),p.push(b)}for(var h in e(a,t)&&a.forEach(function(e,t){var r=i(t,d-1),n=i(e,d-1);b.set(r,n)}),e(a,r)&&a.forEach(function(e){var t=i(e,d-1);b.add(t)}),a){var m;v&&(m=Object.getOwnPropertyDescriptor(v,h)),m&&null==m.set||(b[h]=i(a[h],d-1))}if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(a);for(h=0;h<j.length;h++){var O=j[h];(!(x=Object.getOwnPropertyDescriptor(a,O))||x.enumerable||s)&&(b[O]=i(a[O],d-1),x.enumerable||Object.defineProperty(b,O,{enumerable:!1}))}}if(s){var w=Object.getOwnPropertyNames(a);for(h=0;h<w.length;h++){var x,_=w[h];(x=Object.getOwnPropertyDescriptor(a,_))&&x.enumerable||(b[_]=i(a[_],d-1),Object.defineProperty(b,_,{enumerable:!1}))}}return b}(i,a)}function i(e){return Object.prototype.toString.call(e)}function u(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),t}return o.clonePrototype=function(e){if(null===e)return null;var t=function(){};return t.prototype=e,new t},o.__objToStr=i,o.__isDate=function(e){return"object"==typeof e&&"[object Date]"===i(e)},o.__isArray=function(e){return"object"==typeof e&&"[object Array]"===i(e)},o.__isRegExp=function(e){return"object"==typeof e&&"[object RegExp]"===i(e)},o.__getRegExpFlags=u,o}();e.exports&&(e.exports=t)}(e={exports:{}},e.exports),e.exports);function r(e,t){if(!function(e){return null!==e&&"object"==typeof e}(e)||"string"!=typeof t)return e;for(var r=t.split("."),n=0;n<r.length;n++){var o=r[n];if(null===(e=e.hasOwnProperty(o)?e[o]:null))break}return e}var n=function(e,t){t.add();for(var r=e.length,n=0,o="name";n<r;){var i=e[n++],u=i.charCodeAt(0);58===u||44===u?(o="arg",t.shiftValue()):124===u?(o="name",t.add()):"arg"===o?t.appendValue(i):t.appendKey(i,u)}return t.toJSON()};var o=function(){return{nodes:[],currentNode:null,add:function(){this.currentNode={name:"",args:[]},this.nodes.push(this.currentNode)},appendKey:function(e,t){32!==t&&(this.currentNode.name+=e)},appendValue:function(e){this.currentNode.args[this.currentNode.args.length-1]+=e},shiftValue:function(){this.currentNode.args.push("")},toJSON:function(){return this.nodes}}};function i(e,t){return t=t||{},Object.keys(e).reduce(function(i,u){var f=e[u];if("string"==typeof f)f=n(f,new o);else if(!Array.isArray(f))throw new Error("Rules must be defined as a string or an array");u.indexOf("*")>-1?function e(t,n,o,i){if(!n)return[];o=o||0;var u=t[o++],f=t[o];return i||(i=[u],u=""),i=i.reduce(function(e,t){var o=u?t+"."+u:t;if(void 0!==f){var i=r(n,o);if(Array.isArray(i))for(var a=i.length,c=0;c<a;c++)e.push(o+"."+c)}else e.push(o);return e},[]),o===t.length?i:e(t,n,o,i)}(u.split(/\.\*\.?/),t).forEach(function(e){i[e]=f}):i[u]=f;return i},{})}var u=function(e){return e.replace(/_(\w)/g,function(e,t){return t.toUpperCase()})},f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function a(e){return null!==e&&"object"===(void 0===e?"undefined":f(e))}return function(e){return{sanitize:function(n,o){var f=i(o,n);return Object.keys(f).reduce(function(t,o){var i=r(n,o);return null!==i&&function(e,t,r){if(a(e)&&"string"==typeof t){var n=t.split(".");!function e(t,o){var i=n[o];if(o+1!==n.length)return isNaN(parseInt(n[o+1]))||Array.isArray(t[i])?a(t[i])||(t[i]={}):t[i]=[],e(t[i],o+1);t[i]=r}(e,0)}}(t,o,function(e,t,r){var n=t;return r.forEach(function(t){var r=u(t.name);if("function"!=typeof e[r])throw new Error(r+" is not a sanitization method");n=e[r](n,t.args)}),n}(e,i,f[o])),t},t(n,!1))}}}});
